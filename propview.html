<form id=propview method=POST action=propview>
  <h1 class=sticky id=edit-prop>
    Edit prop <button form=propview class=middle name=prop.save value=prop>Save prop</button>
  </h1>
  <a target=_parent href=mapper#mapeditor>Back to map</a>
  ${
    d => {
      if ( d.req_method == 'GET' ) {
        if ( !! d.query_params && d.query_params.p ) {
          d.prop = Object.assign( I.deep_clone( d.empty_prop ), d.places.find( ({name}) => name == d.query_params.p ) || {} );
        } else {
          d.prop = I.deep_clone( d.empty_prop );
        }
      }
      return '';
    }
  }
  <p>
    <input required name=prop.name placeholder=name value="${T.prop.name}">
  <p>
    <input required name=prop.concepts placeholder=concepts value="${T.prop.concepts}">
  <p>
    <textarea required rows=2 name=prop.desc placeholder=description>${T.prop.desc}</textarea>
  <h2 id=proplocations>Property places</h2>
  <p>
  <dl>
    <dt><label for=generalized>All places</label><input style="width: ${d => (d.prop.size+'').length+1}ch" placeholder=0
        id=size class="txcent report" readonly type=number name=prop.size value="${T.prop.size}"><span class=report>found</span>
    <dd>
      <input type=text size=10 id=generalized name=prop.generalized value="${T.prop.generalized}"><button 
        id=generalize>Get all</button>    </dd>
  <dl>
    <dt>Place examples
    <dd><input class=new type=text value="" size=10 name=prop.locations><button 
      formaction=propview name=prop.savelocation value=new>Save</button>
  ${ d => d.prop.locations.map( (p,idx) => `
    <dd>
      <input type=text size=10 value="${p}" name=prop.locations><button 
        formaction=propview name=prop.dellocation value="${idx}">Del</button>
    ` 
  )}
  </dl>
  <p>
    <button class=middle name=prop.save value=prop>Save prop</button>
</form>
<script src=/scripts/build.js></script>
