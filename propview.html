<h1 id=edit-prop>
  Edit prop
  <button form=propview class=middle name=prop.save value=prop>Save prop</button>
</h1>
<a target=_parent href=mapper#mapeditor>Back to map</a>
${
  d => {
    if ( !! d.query_params && d.query_params.p ) {
      console.log("Query exists", d.query_params );
      d.prop = Object.assign( {}, d.empty_prop, d.places.find( ({name}) => name == d.query_params.p ) || {} );
    } else {
      console.log("Query does not exist");
    }
    return '';
  }
}
<form id=propview method=POST action=propview>
  <p>
    <input name=prop.name placeholder=name value="${T.prop.name}">
  <p>
    <input name=prop.concepts placeholder=concepts value="${T.prop.concepts}">
  <p>
    <textarea rows=3 cols=28 name=prop.desc placeholder=description>${T.prop.desc}</textarea>
  <h2 id=proplocations>Property Locations</h2>
  <p>
  <dl>
    <dt><label for=generalized>Generalized location</label>
    <dd>
      <input type=text id=generalized name=prop.generalized value="${T.prop.generalized}">
      <button id=generalize>G</button>
    </dd>
    <input type=hidden id=ngeneralized name=prop.ngeneralized value="${T.prop.ngeneralized}">
  <dl>
    <dt>Location examples
    <dd><a rel=search target=_parent href=mapper#add-location-view>Add more examples</a>
    <dd><input class=new type=text value="" name=prop.locations><button formaction=propview#proplocations name=prop.savelocation value=new>Save</button>
  ${ d => d.prop.locations.map( (p,idx) => `
    <dd><input type=text value="${p}" name=prop.locations><button formaction=propview#proplocations name=prop.dellocation value="${idx}">Del</button>
    ` ).join('')
  }
  </dl>
  <p>
    <button class=middle name=prop.save value=prop>Save prop</button>
    <button id=clearall type=reset name=prop.reset value=prop>Clear all</button>
</form>
<script src=/scripts/build.js></script>
<script>
  document.querySelector('#clearall').addEventListener('click', e => {
    e.preventDefault();
    const form = e.target.form;
    Array.from(form.elements).forEach( el => {
      switch( el.tagName ) {
        case "INPUT":
          if ( el.type !== 'reset' && el.type !== 'submit' ) {
            el.value = '';
            el.checked = false;
          }
          break;
        case "SELECT":
          Array.from(el.options).forEach( opel => opel.selected = false );
          break;
        case "TEXTAREA":
          el.innerHTML = '';
          break;
      }
    });
  });
</script>
