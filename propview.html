<h1 id=edit-prop>Edit prop</h1>
<form method=POST action=propview>
  <p>
    <input name=prop.name placeholder=name value="${T.prop.name}">
  <p>
    <input name=prop.concepts placeholder=concepts value="${T.prop.concepts}">
  <p>
    <textarea name=prop.description placeholder=description>${T.prop.desc}</textarea>
  <h2 id=prop-locations>Property Locations</h2>
  <p>
    <label for=generalized>Generalized location selector</label>
    <input type=text id=generalized name=prop.generalized value="${T.prop.generalized}">
    <input type=hidden id=ngeneralized name=prop.ngeneralized value="${T.prop.ngeneralized}">
    <button id=generalize>G</button>
  <p>
    <a rel=search target=_parent href=editmap#add-location-view>Add more locations</a>
  <dl>
    <dd><input class=new type=text value="" name=prop.locations><button formaction=propview#prop-locations name=prop.savelocation value=new>Save</button>
  ${ d => d.prop.locations.map( (p,idx) => `
    <dd><input type=text value="${p}" name=prop.locations><button formaction=propview#prop-locations name=prop.dellocation value="${idx}">Del</button>
    ` ).join('')
  }
  </dl>
  <p>
    <button name=prop.save value=prop>Save prop</button>
    <button id=clearall type=reset name=prop.reset value=prop>Clear all</button>
</form>
<script src=/scripts/build.js></script>
<script>
  document.querySelector('#clearall').addEventListener('click', e => {
    e.preventDefault();
    const form = e.target.form;
    Array.from(form.elements).forEach( el => {
      switch( el.tagName ) {
        case "INPUT":
          if ( el.type !== 'reset' && el.type !== 'submit' ) {
            el.value = '';
            el.checked = false;
          }
          break;
        case "SELECT":
          Array.from(el.options).forEach( opel => opel.selected = false );
          break;
        case "TEXTAREA":
          el.innerHTML = '';
          break;
      }
    });
  });
</script>
